import{_ as s,c as n,o as a,a as p}from"./app.bca8d31d.js";const D=JSON.parse('{"title":"Usage With Nuxt 3","description":"","frontmatter":{},"headers":[{"level":2,"title":"SSR-enabled persistence","slug":"ssr-enabled-persistence","link":"#ssr-enabled-persistence","children":[]},{"level":2,"title":"Client-side persistence","slug":"client-side-persistence","link":"#client-side-persistence","children":[]},{"level":2,"title":"Note on Nuxt plugins","slug":"note-on-nuxt-plugins","link":"#note-on-nuxt-plugins","children":[]}],"relativePath":"frameworks/nuxt-3.md","lastUpdated":1669480098000}'),l={name:"frameworks/nuxt-3.md"},e=p(`<h1 id="usage-with-nuxt-3" tabindex="-1">Usage With Nuxt 3 <a class="header-anchor" href="#usage-with-nuxt-3" aria-hidden="true">#</a></h1><p>The plugin provides a factory function to make integration with Nuxt 3 a breeze. It is assumed you have Pinia already installed with <a href="https://pinia.vuejs.org/ssr/nuxt.html" target="_blank" rel="noreferrer"><code>@pinia/nuxt</code></a>.</p><h2 id="ssr-enabled-persistence" tabindex="-1">SSR-enabled persistence <a class="header-anchor" href="#ssr-enabled-persistence" aria-hidden="true">#</a></h2><p>Using Nuxt Cookies allows for persistence with full SSR support.<br> Declare a plugin by creating a <code>persistedstate.ts</code> under the <code>plugins/</code> directory:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// /plugins/persistedstate.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">createNuxtPersistedState</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">pinia-plugin-persistedstate/nuxt</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">useCookie</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">#app</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// optional import as Nuxt will auto-import it</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">defineNuxtPlugin</span><span style="color:#666666;">(</span><span style="color:#BD976A;">nuxtApp</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">nuxtApp</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$pinia</span><span style="color:#666666;">.</span><span style="color:#80A665;">use</span><span style="color:#666666;">(</span><span style="color:#80A665;">createNuxtPersistedState</span><span style="color:#666666;">(</span><span style="color:#BD976A;">useCookie</span><span style="color:#666666;">))</span></span>
<span class="line"><span style="color:#666666;">})</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// /plugins/persistedstate.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">createNuxtPersistedState</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">pinia-plugin-persistedstate/nuxt</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">useCookie</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">#app</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// optional import as Nuxt will auto-import it</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#59873A;">defineNuxtPlugin</span><span style="color:#999999;">(</span><span style="color:#B07D48;">nuxtApp</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">nuxtApp</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$pinia</span><span style="color:#999999;">.</span><span style="color:#59873A;">use</span><span style="color:#999999;">(</span><span style="color:#59873A;">createNuxtPersistedState</span><span style="color:#999999;">(</span><span style="color:#B07D48;">useCookie</span><span style="color:#999999;">))</span></span>
<span class="line"><span style="color:#999999;">})</span></span>
<span class="line"></span></code></pre></div><p><code>createNuxtPersistedState</code> accepts <a href="/pinia-plugin-persistedstate-v2/guide/advanced.html#global-persistence-options">global options</a> as second parameter with the following options available:</p><ul><li><a href="/pinia-plugin-persistedstate-v2/guide/config.html#serializer"><code>serializer</code></a></li><li><a href="/pinia-plugin-persistedstate-v2/guide/config.html#beforeRestore"><code>beforeRestore</code></a></li><li><a href="/pinia-plugin-persistedstate-v2/guide/config.html#afterRestore"><code>afterRestore</code></a></li><li><code>cookieOptions</code></li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>You can specify the <a href="https://v3.nuxtjs.org/api/composables/use-cookie#options" target="_blank" rel="noreferrer">cookie options</a> to the <code>cookieOptions</code> property:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">createNuxtPersistedState</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">pinia-plugin-persistedstate/nuxt</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">defineNuxtPlugin</span><span style="color:#666666;">(</span><span style="color:#BD976A;">nuxtApp</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">nuxtApp</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$pinia</span><span style="color:#666666;">.</span><span style="color:#80A665;">use</span><span style="color:#666666;">(</span><span style="color:#80A665;">createNuxtPersistedState</span><span style="color:#666666;">(</span><span style="color:#BD976A;">useCookie</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">cookieOptions</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#B8A965;">expires</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">3600</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#B8A965;">maxAge</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">3600</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#B8A965;">sameSite</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">strict</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}))</span></span>
<span class="line"><span style="color:#666666;">})</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">createNuxtPersistedState</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">pinia-plugin-persistedstate/nuxt</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#59873A;">defineNuxtPlugin</span><span style="color:#999999;">(</span><span style="color:#B07D48;">nuxtApp</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">nuxtApp</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$pinia</span><span style="color:#999999;">.</span><span style="color:#59873A;">use</span><span style="color:#999999;">(</span><span style="color:#59873A;">createNuxtPersistedState</span><span style="color:#999999;">(</span><span style="color:#B07D48;">useCookie</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">cookieOptions</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#998418;">expires</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">3600</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#998418;">maxAge</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">3600</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#998418;">sameSite</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">strict</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}))</span></span>
<span class="line"><span style="color:#999999;">})</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Overriding the <code>storage</code> option in a store will break its server-side persistence/rehydration with cookies.</p></div><h2 id="client-side-persistence" tabindex="-1">Client-side persistence <a class="header-anchor" href="#client-side-persistence" aria-hidden="true">#</a></h2><p>In case you do not want to use cookies, you can use the default <code>createPersistedState</code> in a client-only plugin. Declare a plugin by creating a <code>persistedstate.client.ts</code> under the <code>plugins/</code> directory.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// /plugins/persistedstate.client.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">createPersistedState</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">pinia-plugin-persistedstate</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">defineNuxtPlugin</span><span style="color:#666666;">(</span><span style="color:#BD976A;">nuxtApp</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">nuxtApp</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$pinia</span><span style="color:#666666;">.</span><span style="color:#80A665;">use</span><span style="color:#666666;">(</span><span style="color:#80A665;">createPersistedState</span><span style="color:#666666;">())</span></span>
<span class="line"><span style="color:#666666;">})</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// /plugins/persistedstate.client.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">createPersistedState</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">pinia-plugin-persistedstate</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#59873A;">defineNuxtPlugin</span><span style="color:#999999;">(</span><span style="color:#B07D48;">nuxtApp</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">nuxtApp</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$pinia</span><span style="color:#999999;">.</span><span style="color:#59873A;">use</span><span style="color:#999999;">(</span><span style="color:#59873A;">createPersistedState</span><span style="color:#999999;">())</span></span>
<span class="line"><span style="color:#999999;">})</span></span>
<span class="line"></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Using client-only persistence when server-side rendering, the store state will most likely be the initial state and <strong>not</strong> the persisted state.</p></div><h2 id="note-on-nuxt-plugins" tabindex="-1">Note on Nuxt plugins <a class="header-anchor" href="#note-on-nuxt-plugins" aria-hidden="true">#</a></h2><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>It is important to note that Nuxt plugins are loaded sequentially. If any of your other plugins requires a Pinia store to be hydrated, you want to make sure the <code>persisted-state</code> plugin is loaded before. You may name the file <code>1.persistedstate.ts</code> to ensure it is loaded first.</p><p>More on this can be found in <a href="https://v3.nuxtjs.org/guide/directory-structure/plugins#plugin-registration-order" target="_blank" rel="noreferrer">Nuxt plugins documentation</a>.</p></div>`,15),o=[e];function t(r,c,i,y,A,d){return a(),n("div",null,o)}const E=s(l,[["render",t]]);export{D as __pageData,E as default};
